var D=Object.defineProperty;var N=(d,t)=>D(d,"name",{value:t,configurable:!0});import{p as v,a,s as y,b as h}from"./sound-D3iNkBN9.js";import{v as P}from"./utils-mddd3nEY.js";const E={BASE_FRICTION:.985,MOBILE_FRICTION:.8,BASE_MIN_VELOCITY:.05,MOBILE_MIN_VELOCITY:.07,BASE_HIT_POWER:15,MOBILE_HIT_POWER:7,PAW_HIT_POWER:4,CAT_COOLDOWN:60},W={MUSIC_VOLUME:.45,SOUND_EFFECT_VOLUME:.15,VIBRATION_DURATION:{HIT:50,WALL_HIT:30,MEOW:[100,50,100],SUCCESS:[100,50,100,50,100],TOUCH_START:20,TOUCH_END:40}},m={MOBILE_BREAKPOINT:640,DEBOUNCE_DELAY:100,ORIENTATION_CHANGE_DELAY:200},H={MAX_POWER:25,POWER_SENSITIVITY:6,AIM_LINE_LENGTH:150},p={GAME_AREA:"#game-area",TABLE:"#billiard-table",TABLE_CONTAINER:"#billiard-table-container",TRAJECTORY_CANVAS:"#trajectory-canvas",CUE:"#cue",AIM_LINE:"#aim-line",POWER_INDICATOR:"#power-indicator",POWER_FILL:"#power-fill",BILLIARD_BALLS:".billiard-ball",PYRAMID_CONTAINER:"#ball-pyramid",CAT_CONTAINERS:".cat-container",POCKETS:"[data-pocket]",SCORE_DISPLAY:"#score-display",SCORE_DISPLAY_LANDSCAPE:"#score-display-landscape",HELP_MODAL:"#help-modal",ROTATION_NOTICE:"#rotation-notice"},c={MOBILE_RADIUS_MULTIPLIER:.4,MOBILE_COOLDOWN_MULTIPLIER:2,MOBILE_SPEED_THRESHOLD:3,MOBILE_PAW_POWER_MULTIPLIER:.25,SWAT_ANIMATION_DURATION:300,SMALL_CAT_ANIMATION_DURATION:500,EMOJI_DISPLAY_DURATION:1300},G={VISUAL_RADIUS_MULTIPLIER:.95,MOBILE_VISUAL_RADIUS_MULTIPLIER:.8,MIN_RADIUS:6,MIN_MOBILE_RADIUS:4},k={BASE_TABLE_WIDTH:800,BASE_TABLE_HEIGHT:533,BREAKPOINTS:{SM:480,MD:768,LG:1024},CAT_SCALES:{BASE:1,LG:1,MD:.9,SM:.7},BALL_SIZES:{BASE:24,LG:28,MD:32,SM:36},POCKET_SIZES:{BASE:36,LG:42,MD:48,SM:54},CUE_SIZES:{HEIGHT:{BASE:6,LG:7,MD:8,SM:9},WIDTH_PERCENT:{BASE:30,LG:35,MD:40,SM:45}},BUTTON_SIZES:{FONT:{BASE:16,LG:14,MD:12,SM:10},PADDING_X:{BASE:16,LG:12,MD:8,SM:6},PADDING_Y:{BASE:8,LG:6,MD:4,SM:3}},SCORE_SIZES:{FONT:{BASE:32,LG:28,MD:24,SM:20}},POWER_INDICATOR_SIZES:{WIDTH:{BASE:200,LG:150,MD:100,SM:80},HEIGHT:{BASE:15,LG:12,MD:10,SM:8}}},F={SOUND_ENABLED:"kitt-cues-sound",MUSIC_ENABLED:"kitt-cues-music",MUSIC_VOLUME:"kitt-cues-music-volume"},V={POWER_MULTIPLIER:25,MIN_POWER_THRESHOLD:.1},S=class S{constructor(t=!1){this.isMobile=t,this.settings={friction:t?E.MOBILE_FRICTION:E.BASE_FRICTION,minVelocity:t?E.MOBILE_MIN_VELOCITY:E.BASE_MIN_VELOCITY,hitPower:t?E.MOBILE_HIT_POWER:E.BASE_HIT_POWER}}updateSettings(t){this.isMobile=t,this.settings={friction:t?E.MOBILE_FRICTION:E.BASE_FRICTION,minVelocity:t?E.MOBILE_MIN_VELOCITY:E.BASE_MIN_VELOCITY,hitPower:t?E.MOBILE_HIT_POWER:E.BASE_HIT_POWER}}updateBallPhysics(t,s,i,I,n){return t.sunk||(Math.abs(t.vx)<this.settings.minVelocity&&(t.vx=0),Math.abs(t.vy)<this.settings.minVelocity&&(t.vy=0),t.vx===0&&t.vy===0)?!1:(t.vx*=this.settings.friction,t.vy*=this.settings.friction,t.x+=t.vx,t.y+=t.vy,this.checkPocketCollisions(t,n),t.sunk||(this.checkWallCollisions(t,s,i),this.checkCatCollisions(t,I)),!0)}checkPocketCollisions(t,s){for(const i of s){const I=t.x-i.x,n=t.y-i.y,_=Math.sqrt(I*I+n*n),o=this.isMobile?i.radius*.6:i.radius;if(_<o&&!t.sunk){t.sunk=!0,t.vx=0,t.vy=0,t.el.style.display="none",v();return}}}checkWallCollisions(t,s,i){(t.x-t.radius<0&&t.vx<0||t.x+t.radius>s&&t.vx>0)&&(t.vx*=-1,a(Math.abs(t.vx)),t.x-t.radius<0&&(t.x=t.radius),t.x+t.radius>s&&(t.x=s-t.radius)),(t.y-t.radius<0&&t.vy<0||t.y+t.radius>i&&t.vy>0)&&(t.vy*=-1,a(Math.abs(t.vy)),t.y-t.radius<0&&(t.y=t.radius),t.y+t.radius>i&&(t.y=i-t.radius))}checkCatCollisions(t,s){for(const i of s){if(i.cooldown>0||t.sunk)continue;const I=t.x-i.x,n=t.y-i.y,_=Math.sqrt(I*I+n*n);if(_<t.radius+i.radius){if(this.isMobile&&Math.hypot(t.vx,t.vy)<c.MOBILE_SPEED_THRESHOLD)continue;this.handleCatHit(t,i,I,n,_)}}}handleCatHit(t,s,i,I,n){s.cooldown=this.isMobile?E.CAT_COOLDOWN*c.MOBILE_COOLDOWN_MULTIPLIER:E.CAT_COOLDOWN,this.animateCatSwat(s);const _=Math.atan2(I,i),o=this.isMobile?Math.max(1,E.PAW_HIT_POWER*c.MOBILE_PAW_POWER_MULTIPLIER):E.PAW_HIT_POWER;y.playPawHit(o),document.dispatchEvent(new CustomEvent("cat-hit")),t.vx=Math.cos(_)*o,t.vy=Math.sin(_)*o;const e=t.radius+s.radius-n+1;t.x+=Math.cos(_)*e,t.y+=Math.sin(_)*e}animateCatSwat(t){if(t.el.classList.contains("cat-small"))t.el.classList.add("swat-animation"),setTimeout(()=>{t.el.classList.remove("swat-animation")},c.SMALL_CAT_ANIMATION_DURATION);else{const s=t.pawEl||t.el;s.classList.add("swat-animation"),setTimeout(()=>{s.classList.remove("swat-animation")},c.SWAT_ANIMATION_DURATION)}}checkBallCollisions(t){for(let s=0;s<t.length;s++)if(!t[s].sunk)for(let i=s+1;i<t.length;i++)t[i].sunk||this.handleBallCollision(t[s],t[i])}handleBallCollision(t,s){const i=s.x-t.x,I=s.y-t.y,n=Math.sqrt(i*i+I*I);if(n<t.radius+s.radius){const _=Math.atan2(I,i),o=Math.sin(_),e=Math.cos(_);let O=t.vx*e+t.vy*o,L=t.vy*e-t.vx*o,A=s.vx*e+s.vy*o,M=s.vy*e-s.vx*o;const u=O;O=A,A=u,t.vx=O*e-L*o,t.vy=L*e+O*o,s.vx=A*e-M*o,s.vy=M*e+A*o;const T=t.radius+s.radius-n+1,r=T/2*e,C=T/2*o;t.x-=r,t.y-=C,s.x+=r,s.y+=C;const B=Math.hypot(O-A,L-M);h(B)}}updateCats(t){for(const s of t)s.cooldown>0&&s.cooldown--}applyForce(t,s,i){if(t.vx=-Math.cos(s)*i,t.vy=-Math.sin(s)*i,this.isMobile){const I=Math.min(i*2,30);P(I)}}areAllBallsStopped(t){return t.every(s=>s.sunk||s.vx===0&&s.vy===0)}getSettings(){return{...this.settings}}};N(S,"PhysicsEngine");let R=S;export{W as A,c as C,p as D,H as G,V as J,R as P,F as S,m as U,k as a,G as b};

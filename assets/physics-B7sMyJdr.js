var y=Object.defineProperty;var a=(u,t)=>y(u,"name",{value:t,configurable:!0});import{p as h,a as N,s as P,b as B}from"./sound-BKkSYDmk.js";import{v as x}from"./utils-mddd3nEY.js";const I={BASE_FRICTION:.985,MOBILE_FRICTION:.8,BASE_MIN_VELOCITY:.05,MOBILE_MIN_VELOCITY:.07,BASE_HIT_POWER:15,MOBILE_HIT_POWER:7,PAW_HIT_POWER:4,CAT_COOLDOWN:60},m={MUSIC_VOLUME:.45,SOUND_EFFECT_VOLUME:.15,VIBRATION_DURATION:{HIT:50,WALL_HIT:30,MEOW:[100,50,100],SUCCESS:[100,50,100,50,100],TOUCH_START:20,TOUCH_END:40}},p={MOBILE_BREAKPOINT:640,DEBOUNCE_DELAY:100,ORIENTATION_CHANGE_DELAY:200},W={MAX_POWER:25,POWER_SENSITIVITY:6,AIM_LINE_LENGTH:150},H={GAME_AREA:"#game-area",TABLE:"#billiard-table",TABLE_CONTAINER:"#billiard-table-container",TRAJECTORY_CANVAS:"#trajectory-canvas",CUE:"#cue",AIM_LINE:"#aim-line",POWER_INDICATOR:"#power-indicator",POWER_FILL:"#power-fill",BILLIARD_BALLS:".billiard-ball",PYRAMID_CONTAINER:"#ball-pyramid",CAT_CONTAINERS:".cat-container",POCKETS:"[data-pocket]",SCORE_DISPLAY:"#score-display",SCORE_DISPLAY_LANDSCAPE:"#score-display-landscape",HELP_MODAL:"#help-modal",ROTATION_NOTICE:"#rotation-notice"},L={MOBILE_RADIUS_MULTIPLIER:.4,MOBILE_COOLDOWN_MULTIPLIER:2,MOBILE_SPEED_THRESHOLD:3,MOBILE_PAW_POWER_MULTIPLIER:.25,SWAT_ANIMATION_DURATION:300,SMALL_CAT_ANIMATION_DURATION:500,EMOJI_DISPLAY_DURATION:1300},k={VISUAL_RADIUS_MULTIPLIER:.95,MOBILE_VISUAL_RADIUS_MULTIPLIER:.8,MIN_RADIUS:6,MIN_MOBILE_RADIUS:4},F={BASE_TABLE_WIDTH:600,BASE_TABLE_HEIGHT:400,BREAKPOINTS:{XS:280,SM:320,MD:375,LG:640,XL:1024},CAT_SCALES:{XS:.25,SM:.3,MD:.4,LG:.5,XL:1.1},BALL_SIZES:{BASE:16,XS:26,SM:28,MD:30,LG:32}},G={SOUND_ENABLED:"kitt-cues-sound",MUSIC_ENABLED:"kitt-cues-music",MUSIC_VOLUME:"kitt-cues-music-volume"},V={POWER_MULTIPLIER:25,MIN_POWER_THRESHOLD:.1},M=class M{constructor(t=!1){this.isMobile=t,this.settings={friction:t?I.MOBILE_FRICTION:I.BASE_FRICTION,minVelocity:t?I.MOBILE_MIN_VELOCITY:I.BASE_MIN_VELOCITY,hitPower:t?I.MOBILE_HIT_POWER:I.BASE_HIT_POWER}}updateSettings(t){this.isMobile=t,this.settings={friction:t?I.MOBILE_FRICTION:I.BASE_FRICTION,minVelocity:t?I.MOBILE_MIN_VELOCITY:I.BASE_MIN_VELOCITY,hitPower:t?I.MOBILE_HIT_POWER:I.BASE_HIT_POWER}}updateBallPhysics(t,s,i,o,_){return t.sunk||(Math.abs(t.vx)<this.settings.minVelocity&&(t.vx=0),Math.abs(t.vy)<this.settings.minVelocity&&(t.vy=0),t.vx===0&&t.vy===0)?!1:(t.vx*=this.settings.friction,t.vy*=this.settings.friction,t.x+=t.vx,t.y+=t.vy,this.checkPocketCollisions(t,_),t.sunk||(this.checkWallCollisions(t,s,i),this.checkCatCollisions(t,o)),!0)}checkPocketCollisions(t,s){for(const i of s){const o=t.x-i.x,_=t.y-i.y,e=Math.sqrt(o*o+_*_),n=this.isMobile?i.radius*.6:i.radius;if(e<n&&!t.sunk){t.sunk=!0,t.vx=0,t.vy=0,t.el.style.display="none",h();return}}}checkWallCollisions(t,s,i){(t.x-t.radius<0&&t.vx<0||t.x+t.radius>s&&t.vx>0)&&(t.vx*=-1,N(Math.abs(t.vx)),t.x-t.radius<0&&(t.x=t.radius),t.x+t.radius>s&&(t.x=s-t.radius)),(t.y-t.radius<0&&t.vy<0||t.y+t.radius>i&&t.vy>0)&&(t.vy*=-1,N(Math.abs(t.vy)),t.y-t.radius<0&&(t.y=t.radius),t.y+t.radius>i&&(t.y=i-t.radius))}checkCatCollisions(t,s){for(const i of s){if(i.cooldown>0||t.sunk)continue;const o=t.x-i.x,_=t.y-i.y,e=Math.sqrt(o*o+_*_);if(e<t.radius+i.radius){if(this.isMobile&&Math.hypot(t.vx,t.vy)<L.MOBILE_SPEED_THRESHOLD)continue;this.handleCatHit(t,i,o,_,e)}}}handleCatHit(t,s,i,o,_){s.cooldown=this.isMobile?I.CAT_COOLDOWN*L.MOBILE_COOLDOWN_MULTIPLIER:I.CAT_COOLDOWN,this.animateCatSwat(s);const e=Math.atan2(o,i),n=this.isMobile?Math.max(1,I.PAW_HIT_POWER*L.MOBILE_PAW_POWER_MULTIPLIER):I.PAW_HIT_POWER;P.playPawHit(n),document.dispatchEvent(new CustomEvent("cat-hit")),t.vx=Math.cos(e)*n,t.vy=Math.sin(e)*n;const E=t.radius+s.radius-_+1;t.x+=Math.cos(e)*E,t.y+=Math.sin(e)*E}animateCatSwat(t){if(t.el.classList.contains("cat-small"))t.el.classList.add("swat-animation"),setTimeout(()=>{t.el.classList.remove("swat-animation")},L.SMALL_CAT_ANIMATION_DURATION);else{const s=t.pawEl||t.el;s.classList.add("swat-animation"),setTimeout(()=>{s.classList.remove("swat-animation")},L.SWAT_ANIMATION_DURATION)}}checkBallCollisions(t){for(let s=0;s<t.length;s++)if(!t[s].sunk)for(let i=s+1;i<t.length;i++)t[i].sunk||this.handleBallCollision(t[s],t[i])}handleBallCollision(t,s){const i=s.x-t.x,o=s.y-t.y,_=Math.sqrt(i*i+o*o);if(_<t.radius+s.radius){const e=Math.atan2(o,i),n=Math.sin(e),E=Math.cos(e);let O=t.vx*E+t.vy*n,A=t.vy*E-t.vx*n,c=s.vx*E+s.vy*n,T=s.vy*E-s.vx*n;const R=O;O=c,c=R,t.vx=O*E-A*n,t.vy=A*E+O*n,s.vx=c*E-T*n,s.vy=T*E+c*n;const r=t.radius+s.radius-_+1,C=r/2*E,S=r/2*n;t.x-=C,t.y-=S,s.x+=C,s.y+=S;const v=Math.hypot(O-c,A-T);B(v)}}updateCats(t){for(const s of t)s.cooldown>0&&s.cooldown--}applyForce(t,s,i){if(t.vx=-Math.cos(s)*i,t.vy=-Math.sin(s)*i,this.isMobile){const o=Math.min(i*2,30);x(o)}}areAllBallsStopped(t){return t.every(s=>s.sunk||s.vx===0&&s.vy===0)}getSettings(){return{...this.settings}}};a(M,"PhysicsEngine");let d=M;export{m as A,L as C,H as D,W as G,V as J,d as P,G as S,p as U,F as a,k as b};

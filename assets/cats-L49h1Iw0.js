var E=Object.defineProperty;var u=(w,t)=>E(w,"name",{value:t,configurable:!0});import{D as x,C as r}from"./physics-CneykC2A.js";const g=class g{constructor(t=!1){this.cats=[],this.isMobile=!1,this.isMobile=t}initializeCats(t){this.cats=[];const s=document.querySelectorAll(x.CAT_CONTAINERS),o=t.getBoundingClientRect();return s.forEach(e=>{const n=e.getBoundingClientRect(),a=n.left-o.left+n.width/2,l=n.top-o.top+n.height/2;let i=Math.max(n.width,n.height)/2;e.classList.contains("cat-small")&&(i=Math.max(n.width,n.height)/2),this.isMobile&&(i*=r.MOBILE_RADIUS_MULTIPLIER);const c={el:e,pawEl:e.querySelector(".hitting-paw"),x:a,y:l,radius:i,cooldown:0,initialPosition:{left:e.style.left,top:e.style.top,transform:e.style.transform}};this.cats.push(c)}),this.cats}getCats(){return this.cats}updateMobileSettings(t){this.isMobile=t,this.cats.forEach(s=>{const o=Math.max(s.el.offsetWidth,s.el.offsetHeight)/2;s.radius=this.isMobile?o*r.MOBILE_RADIUS_MULTIPLIER:o})}showCatEmoji(t,s,o){try{const e=document.createElement("div");e.className="cat-emoji",e.textContent=s;const a=(t.el.querySelector(".cat-head")||t.el).getBoundingClientRect(),l=o.getBoundingClientRect(),i=a.left-l.left+a.width/2,c=a.top-l.top-6;e.style.left=`${i}px`,e.style.top=`${c}px`,o.appendChild(e),setTimeout(()=>{e.parentElement&&e.remove()},r.EMOJI_DISPLAY_DURATION)}catch{}}showAllCatsEmoji(t,s){this.cats.forEach(o=>{this.showCatEmoji(o,t,s)})}updateCatCooldowns(){this.cats.forEach(t=>{t.cooldown>0&&t.cooldown--})}isCatReady(t){return t.cooldown===0}setCatCooldown(t){t.cooldown=this.isMobile?r.MOBILE_COOLDOWN_MULTIPLIER*60:60}animateCatSwat(t){if(t.el.classList.contains("cat-small"))t.el.classList.add("swat-animation"),setTimeout(()=>{t.el.classList.remove("swat-animation")},r.SMALL_CAT_ANIMATION_DURATION);else{const s=t.pawEl||t.el;s.classList.add("swat-animation"),setTimeout(()=>{s.classList.remove("swat-animation")},r.SWAT_ANIMATION_DURATION)}}getCatAtPosition(t,s,o=0){for(const e of this.cats){const n=t-e.x,a=s-e.y;if(Math.sqrt(n*n+a*a)<e.radius+o)return e}return null}getCatsByType(t){return this.cats.filter(s=>s.el.classList.contains(t))}getAllCats(){return[...this.cats]}getCatCount(){return this.cats.length}resetAllCats(){this.cats.forEach(t=>{t.cooldown=0,t.el.classList.remove("swat-animation"),t.pawEl&&t.pawEl.classList.remove("swat-animation")})}getOrangeCats(){return this.getCatsByType("cat-orange")}getGrayCats(){return this.getCatsByType("cat-gray")}getWhiteCats(){return this.getCatsByType("cat-white")}getSmallCats(){return this.getCatsByType("cat-small")}makeOrangeCatsHappy(t){this.getOrangeCats().forEach(s=>{this.showCatEmoji(s,"ðŸ˜º",t)})}makeGrayCatsSad(t){this.getGrayCats().forEach(s=>{this.showCatEmoji(s,"ðŸ˜¿",t)})}makeWhiteCatsExcited(t){this.getWhiteCats().forEach(s=>{this.showCatEmoji(s,"ðŸ˜¸",t)})}makeSmallCatsSurprised(t){this.getSmallCats().forEach(s=>{this.showCatEmoji(s,"ðŸ™€",t)})}getCatInfo(t){let s="unknown";return t.el.classList.contains("cat-orange")?s="orange":t.el.classList.contains("cat-gray")?s="gray":t.el.classList.contains("cat-white")?s="white":t.el.classList.contains("cat-small")&&(s="small"),{type:s,position:{x:t.x,y:t.y},radius:t.radius,cooldown:t.cooldown,isReady:this.isCatReady(t)}}updateCatPositions(t){const s=t.getBoundingClientRect();this.cats.forEach(o=>{const e=o.el.getBoundingClientRect();o.x=e.left-s.left+e.width/2,o.y=e.top-s.top+e.height/2})}getClosestCat(t,s){let o=null;for(const e of this.cats){const n=t-e.x,a=s-e.y,l=Math.sqrt(n*n+a*a);(!o||l<o.distance)&&(o={cat:e,distance:l})}return o}getCatsInRadius(t,s,o){return this.cats.filter(e=>{const n=t-e.x,a=s-e.y;return Math.sqrt(n*n+a*a)<=o})}checkTrajectoryIntersection(t,s,o,e,n=8){const a={x1:t,y1:s,x2:o,y2:e};for(const l of this.cats)if(this.lineIntersectsCircle(a,l.x,l.y,l.radius+n))return l;return null}lineIntersectsCircle(t,s,o,e){const n=t.x2-t.x1,a=t.y2-t.y1,l=t.x1-s,i=t.y1-o,c=l*n+i*a,h=n*n+a*a;if(h===0)return!1;const d=c/h;let f,m;d<0?(f=t.x1,m=t.y1):d>1?(f=t.x2,m=t.y2):(f=t.x1+d*n,m=t.y1+d*a);const y=s-f,p=o-m;return y*y+p*p<=e*e}startCatnado(t){const s=t.getBoundingClientRect(),o=s.width/2,e=s.height/2,n=this.cats.map(l=>{const i=l.x-o,c=l.y-e;return{cat:l,angle:Math.atan2(c,i),radius:Math.sqrt(i*i+c*c),speed:.02,expanding:!1}}),a=u(()=>{let l=!1;n.forEach(i=>{i.speed+=.002,i.angle+=i.speed,i.speed>.2&&(i.expanding=!0),i.expanding&&(i.radius+=10+i.speed*50);const c=o+Math.cos(i.angle)*i.radius,h=e+Math.sin(i.angle)*i.radius;i.cat.el.style.left=`${c-i.cat.el.offsetWidth/2}px`,i.cat.el.style.top=`${h-i.cat.el.offsetHeight/2}px`,i.cat.el.style.transform=`rotate(${i.angle*57.29+90}deg) scale(${i.expanding?1+i.speed:1})`,i.radius<3e3&&(l=!0)}),l?requestAnimationFrame(a):setTimeout(()=>{document.dispatchEvent(new CustomEvent("catnado-finished"))},500)},"animate");requestAnimationFrame(a)}resetCats(){this.cats.forEach(t=>{t.initialPosition&&(t.el.style.left=t.initialPosition.left,t.el.style.top=t.initialPosition.top,t.el.style.transform=t.initialPosition.transform),t.el.classList.remove("swat-animation")})}};u(g,"CatManager");let C=g;const M=new C;export{M as c};
